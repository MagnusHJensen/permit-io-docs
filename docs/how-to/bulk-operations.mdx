---
sidebar_position: 8
title: Perform Bulk Operations
---

Navigate through the various bulk operations supported in Permit and their usage.

---

Bulk operations on data is a key for a system built to scale, help developers to perform large operations on data in a single request.
In a policy system, it especially true for operations required in user sync and graph policy updates.
The following guide, will take you through the current implemented bulk operations offered by Permit, and why to use them in your application.

:::tipUsing Bulk Operations in Permit SDKs
While all the examples in this document performed in plain HTTP requests, our SDKs supports many of these operations in a more convenient way.

Take a look in the SDK feature parity page to find if your SDK supports the operation you need.

In case you miss a feature, please join our community and let us know.
:::

## Bulk User Operations
When working with Permit, the users play the central role in the system as the subjects we would like to control access to.
With Permit focuses on authorization and not identity management, the user data is usually managed in external systems, and the user data is synced to Permit.
The most efficient way to sync your initial user data, or to update a large number of users, is to use the bulk user operations.

In Permit, the following bulk user operations are supported:

```bash
# Create new users
curl -X POST https://api.permit.io/v2/facts/{proj_id}/{env_id}/bulk/users \
    -H "Authorization: Bearer {your_permit_token}" \
    -H "Content-Type: application/json" \
    -d '{
            "operations": [{
            "key": "user|892179821739812389327",
            "email": "jane@coolcompany.com",
            "first_name": "Jane",
            "last_name": "Doe",
            "attributes": {}
            }, ...]
        }'


# Update existing users
curl -X PUT https://api.permit.io/v2/facts/{proj_id}/{env_id}/bulk/users
    -H "Authorization: Bearer {your_permit_token}" \
    -H "Content-Type: application/json" \
    -d '{
            "operations": [{
            "key": "user|892179821739812389327",
            "email": "
            "first_name": "Jane",
            "last_name": "Doe",
            "attributes": {}
            }, ...]
        }'

# Delete existing users
curl -X DELETE https://api.permit.io/v2/facts/{proj_id}/{env_id}/bulk/users
    -H "Authorization: Bearer {your_permit_token}" \
    -H "Content-Type: application/json" \
    -d '{
            "idents": ["user|892179821739812389327", ...]
        }'
```

### Bulk Tenant Operations
In Permit, the tenants are the silos that holds users, help you to model the same account -> user as your application does.
Same as you'd like to perform bulk operations on users, you might want to perform bulk operations on tenants.

In Permit, the following bulk tenant operations are supported:

```bash
# Create new tenants
curl -X POST https://api.permit.io/v2/facts/{proj_id}/{env_id}/bulk/tenants \
    -
    -H "Authorization: Bearer {your_permit_token}" \
    -H "Content-Type: application/json" \
    -d '{
            "operations": [{
                "key": "cool_company",
                "name": "Cool Company",
                "attributes": {}
            }, ...]
        }'

# Delete existing tenants
curl -X DELETE https://api.permit.io/v2/facts/{proj_id}/{env_id}/bulk/tenants
    -H "Authorization: Bearer {your_permit_token}" \
    -H "Content-Type: application/json" \
    -d '{
            "idents": ["stripeince", ...]
        }'
```


## Bulk Role assignment
As you set the users in the system, you'd mostly want to assign them roles.
It is also common to perform bulk role assignments when you decide to create a new type of role in the system and assign it in a workflow to a large number of users.

Another common use case, is updating resource roles of specific users to maintain rebac relationship. While you can do it in a single request, the nature of large-scale system would make it efficient to perform it in a bulk operation.

Permit support assignment and removal of roles in bulk, using the following operations:

```bash
curl -X POST https://api.permit.io/v2/facts/{proj_id}/{env_id}/role_assignments/bulk \
    -H "Authorization: Bearer {your_permit_token}" \
    -H "Content-Type: application/json" \
    -d '[{
                "user": "892179821739812389327",
                "role": "admin",
                "tenant": "default"
            }, ...]'

curl -X DELETE https://api.permit.io/v2/facts/{proj_id}/{env_id}/role_assignments/bulk \
    -H "Authorization: Bearer {your_permit_token}" \
    -H "Content-Type: application/json" \
    -d '[{
                "user": "892179821739812389327",
                "role": "owner:892179821739812389327",
                "tenant": "stripeince"
            }, ...]'
```

## Bulk Resource Operations
In ReBAC policy, it is very important to keep your resource data in sync with the policy graph in Permit.
While you can use the resource instance APIs to sync this data for single request, it is more efficient to perform bulk operations on resources.
In case you need to perform many of such operations, we recommend to use the bulk resource operations.

In Permit, the following bulk resource operations are supported:

```bash
# Update existing resource instances
curl -X PUT https://api.permit.io/v2/facts/{proj_id}/{env_id}/bulk/resource_instances
    -H "Authorization: Bearer {your_permit_token}" \
    -H "Content-Type: application/json" \
    -d '{
            "operations": [{                
                "key": "react",
                "resource": "repository",
                "tenant": "default",
                "attributes": {}
                }
            }, ...]
        }'

# Delete existing resource instances
curl -X DELETE https://api.permit.io/v2/facts/{proj_id}/{env_id}/bulk/resource_instances \
    -H "Authorization: Bearer {your_permit_token}" \
    -H "Content-Type: application/json" \
    -d '{
            "idents": ["repository:react", ...]
        }'
```

### Bulk Relationship Operations
Another aspect of such resource operations, is the ability to maintain the nodes of the policy graph by editing the relationship tuples between the resource instances.
Same as resource instance, in most of the cases, that would be event driven and use single requests to update it just in time, but in case you need to perform many of such operations, we recommend to use the bulk relationship operations.

In Permit, the following bulk resource operations are supported:

```bash
# Create new relationships
curl -X POST https://api.permit.io/v2/facts/{proj_id}/{env_id}/relationship_tuples/bulk
    -H "Authorization: Bearer {your_permit_token}" \
    -H "Content-Type: application/json" \
    -d '{
            "operations": [{
                "subject": "organization:permitio",
                "relation": "owner",
                "object": "repo:opal",
                "tenant": "public"
            }, ...]
        }'

# Delete existing relationships
curl -X DELETE https://api.permit.io/v2/facts/{proj_id}/{env_id}/relationship_tuples/bulk \
    -H "Authorization: Bearer {your_permit_token}" \
    -H "Content-Type: application/json" \
    -d '{
            "idents": [{
                "subject": "organization:permitio",
                "relation": "owner",
                "object": "repo:removed_repo"
            }, ...]
        }'
```
